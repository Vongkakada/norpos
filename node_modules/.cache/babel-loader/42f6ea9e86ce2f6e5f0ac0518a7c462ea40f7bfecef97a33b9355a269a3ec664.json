{"ast":null,"code":"var _jsxFileName = \"D:\\\\CUS\\\\POS Nor Coffee\\\\pos\\\\src\\\\components\\\\ReceiptModal.jsx\";\nimport React from \"react\";\nimport EscPosEncoder from \"escpos-encoder\";\nimport { KHR_SYMBOL, formatKHR } from \"../utils/formatters\";\nimport logo from \"../assets/logo.png\";\nimport qrcode from \"../assets/qrcode.jpg\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SHOP_STATIC_DETAILS = {\n  address: \"ផ្ទះលេខ 137 , ផ្លូវ 223, កំពង់ចាម\",\n  tel: \"016 438 555 / 061 91 4444\"\n};\nfunction ReceiptModal({\n  show,\n  onClose,\n  order,\n  orderId,\n  shopName\n}) {\n  if (!show) return null;\n  const now = new Date();\n  const subtotalKHR = order.reduce((sum, item) => sum + (item.priceKHR || item.priceUSD || 0) * item.quantity, 0);\n  const totalKHR = subtotalKHR;\n  const handlePrintRawBT = async () => {\n    try {\n      const encoder = new EscPosEncoder();\n      encoder.initialize();\n      encoder.align(\"center\").text(shopName).newline();\n      encoder.text(SHOP_STATIC_DETAILS.address).newline();\n      encoder.text(`Tel: ${SHOP_STATIC_DETAILS.tel}`).newline();\n      encoder.text(`Date: ${now.toLocaleDateString()} ${now.toLocaleTimeString()}`).newline();\n      encoder.text(`Invoice: ${orderId}`).newline();\n      encoder.text(\"--------------------------------\").newline();\n\n      // Items\n      order.forEach(item => {\n        encoder.text(`${item.khmerName} (${item.englishName || \"\"})`).newline();\n        encoder.text(`Qty:${item.quantity} ${KHR_SYMBOL}${formatKHR(item.priceKHR || item.priceUSD)}`).newline();\n      });\n      encoder.text(\"--------------------------------\").newline();\n      encoder.text(`Total: ${KHR_SYMBOL}${formatKHR(totalKHR)}`).newline();\n      encoder.text(\"--------------------------------\").newline();\n      encoder.align(\"center\").text(\"សូមអរគុណ! សូមអញ្ជើញមកម្តងទៀត!\").newline();\n\n      // QR code\n      // Note: escpos-encoder supports QR code command\n      const qrData = `ORDER_ID:${orderId};TOTAL:${totalKHR};SHOP:${shopName}`;\n      encoder.qrCode(qrData, {\n        model: 2,\n        size: 6,\n        error: \"M\"\n      });\n      encoder.cut();\n      const data = encoder.encode();\n      const base64Data = btoa(String.fromCharCode(...data));\n      window.location.href = `rawbt://print?base64=${encodeURIComponent(base64Data)}`;\n    } catch (err) {\n      console.error(\"Print Error:\", err);\n      alert(\"⚠ Error printing. Please make sure RawBT is installed.\");\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"modal show\",\n    id: \"receiptModal\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-content\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"close-button\",\n        onClick: onClose,\n        children: \"\\xD7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"print-button-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn-close-receipt\",\n          onClick: onClose,\n          children: \"\\u1794\\u17C4\\u17C7\\u1794\\u1784\\u17CB\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn-print\",\n          onClick: handlePrintRawBT,\n          children: \"\\u1794\\u17C4\\u17C7\\u1796\\u17BB\\u1798\\u17D2\\u1796\\u179C\\u17B7\\u1780\\u17D2\\u1780\\u1799\\u1794\\u178F\\u17D2\\u179A\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 63,\n    columnNumber: 5\n  }, this);\n}\n_c = ReceiptModal;\nexport default ReceiptModal;\nvar _c;\n$RefreshReg$(_c, \"ReceiptModal\");","map":{"version":3,"names":["React","EscPosEncoder","KHR_SYMBOL","formatKHR","logo","qrcode","jsxDEV","_jsxDEV","SHOP_STATIC_DETAILS","address","tel","ReceiptModal","show","onClose","order","orderId","shopName","now","Date","subtotalKHR","reduce","sum","item","priceKHR","priceUSD","quantity","totalKHR","handlePrintRawBT","encoder","initialize","align","text","newline","toLocaleDateString","toLocaleTimeString","forEach","khmerName","englishName","qrData","qrCode","model","size","error","cut","data","encode","base64Data","btoa","String","fromCharCode","window","location","href","encodeURIComponent","err","console","alert","className","id","children","onClick","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/CUS/POS Nor Coffee/pos/src/components/ReceiptModal.jsx"],"sourcesContent":["import React from \"react\";\r\nimport EscPosEncoder from \"escpos-encoder\";\r\nimport { KHR_SYMBOL, formatKHR } from \"../utils/formatters\";\r\nimport logo from \"../assets/logo.png\";\r\nimport qrcode from \"../assets/qrcode.jpg\";\r\n\r\nconst SHOP_STATIC_DETAILS = {\r\n  address: \"ផ្ទះលេខ 137 , ផ្លូវ 223, កំពង់ចាម\",\r\n  tel: \"016 438 555 / 061 91 4444\",\r\n};\r\n\r\nfunction ReceiptModal({ show, onClose, order, orderId, shopName }) {\r\n  if (!show) return null;\r\n\r\n  const now = new Date();\r\n  const subtotalKHR = order.reduce(\r\n    (sum, item) => sum + (item.priceKHR || item.priceUSD || 0) * item.quantity,\r\n    0\r\n  );\r\n  const totalKHR = subtotalKHR;\r\n\r\n  const handlePrintRawBT = async () => {\r\n    try {\r\n      const encoder = new EscPosEncoder();\r\n      encoder.initialize();\r\n      encoder.align(\"center\").text(shopName).newline();\r\n      encoder.text(SHOP_STATIC_DETAILS.address).newline();\r\n      encoder.text(`Tel: ${SHOP_STATIC_DETAILS.tel}`).newline();\r\n      encoder.text(`Date: ${now.toLocaleDateString()} ${now.toLocaleTimeString()}`).newline();\r\n      encoder.text(`Invoice: ${orderId}`).newline();\r\n      encoder.text(\"--------------------------------\").newline();\r\n\r\n      // Items\r\n      order.forEach((item) => {\r\n        encoder.text(`${item.khmerName} (${item.englishName || \"\"})`).newline();\r\n        encoder.text(`Qty:${item.quantity} ${KHR_SYMBOL}${formatKHR(item.priceKHR || item.priceUSD)}`).newline();\r\n      });\r\n\r\n      encoder.text(\"--------------------------------\").newline();\r\n      encoder.text(`Total: ${KHR_SYMBOL}${formatKHR(totalKHR)}`).newline();\r\n      encoder.text(\"--------------------------------\").newline();\r\n\r\n      encoder.align(\"center\").text(\"សូមអរគុណ! សូមអញ្ជើញមកម្តងទៀត!\").newline();\r\n\r\n      // QR code\r\n      // Note: escpos-encoder supports QR code command\r\n      const qrData = `ORDER_ID:${orderId};TOTAL:${totalKHR};SHOP:${shopName}`;\r\n      encoder.qrCode(qrData, { model: 2, size: 6, error: \"M\" });\r\n\r\n      encoder.cut();\r\n\r\n      const data = encoder.encode();\r\n      const base64Data = btoa(String.fromCharCode(...data));\r\n\r\n      window.location.href = `rawbt://print?base64=${encodeURIComponent(base64Data)}`;\r\n    } catch (err) {\r\n      console.error(\"Print Error:\", err);\r\n      alert(\"⚠ Error printing. Please make sure RawBT is installed.\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"modal show\" id=\"receiptModal\">\r\n      <div className=\"modal-content\">\r\n        <span className=\"close-button\" onClick={onClose}>\r\n          ×\r\n        </span>\r\n\r\n        <div className=\"print-button-container\">\r\n          <button className=\"btn-close-receipt\" onClick={onClose}>\r\n            បោះបង់\r\n          </button>\r\n          <button className=\"btn-print\" onClick={handlePrintRawBT}>\r\n            បោះពុម្ពវិក្កយបត្រ\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ReceiptModal;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}